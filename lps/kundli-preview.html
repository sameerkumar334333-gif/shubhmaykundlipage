<!DOCTYPE html>
<html lang="hi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/assets/images/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon.png" sizes="180x180">
  <link rel="preconnect" href="https://yhxbwlhfjznajnnlduwt.supabase.co" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;600;700&family=Inter:wght@400;500;600&display=optional"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <script>
    (function () {
      // sanitize URL: remove dob from query so it never reaches GTM / Meta
      try {
        var url = new URL(window.location.href);
        if (url.searchParams.has('dob')) {
          url.searchParams.delete('dob');
          var qs = url.searchParams.toString();
          var clean = url.origin + url.pathname + (qs ? ('?' + qs) : '') + url.hash;
          window.history.replaceState({}, document.title, clean);
        }
      } catch (e) { }
      var _sid = sessionStorage.getItem('shubhmay_sid');
      if (!_sid) {
        _sid = 's_' + Date.now() + '_' + Math.random().toString(36).slice(2, 11);
        sessionStorage.setItem('shubhmay_sid', _sid);
        sessionStorage.setItem('shubhmay_session_start_ts', String(Date.now()));
      }
      window._shubhmaySid = _sid;
      var params = new URLSearchParams(window.location.search);
      ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term'].forEach(function (k) {
        var v = params.get(k);
        if (v && !sessionStorage.getItem('shubhmay_' + k)) sessionStorage.setItem('shubhmay_' + k, v);
      });
      function getAttribution() {
        var o = {};
        var st = sessionStorage.getItem('shubhmay_session_start_ts');
        if (st) o.session_start_ts = parseInt(st, 10);
        ['utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term'].forEach(function (k) {
          var v = sessionStorage.getItem('shubhmay_' + k);
          if (v) o[k] = v;
        });
        return o;
      }
      try {
        window._shubhmaySupabase = window.supabase ? window.supabase.createClient('https://yhxbwlhfjznajnnlduwt.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InloeGJ3bGhmanpuYWpubmxkdXd0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE3MDc0NjYsImV4cCI6MjA4NzI4MzQ2Nn0.IVZ9AjLF5FgMG4_W1vhGNUX-JSpblj2nhtgkkJn7-MY') : null;
      } catch (e) { window._shubhmaySupabase = null; }
      window._shubhmayTrack = function (et, pl) {
        var payload = Object.assign({}, getAttribution(), pl || {});
        var ev = { session_id: _sid, page_url: location.href, referrer: document.referrer || null, event_type: et, payload: payload, user_agent: navigator.userAgent, language: navigator.language };
        if (window._shubhmaySupabase) try { window._shubhmaySupabase.from('analytics_events').insert([ev]).then(function () { }, function () { }); } catch (e) { }
      };
      if (window._shubhmaySupabase) window._shubhmayTrack('page_view', { page: 'kundli_preview', funnel: 'kundli_preview' });
      if (window._shubhmaySupabase) window._shubhmayTrack('step_view', { step_index: 1, step_name: 'form', funnel: 'kundli_preview' });

      if ('performance' in window && 'PerformanceObserver' in window) {
        try {
          var fcp = null;
          var lcp = null;

          var paintObserver = new PerformanceObserver(function (list) {
            list.getEntries().forEach(function (entry) {
              if (entry.name === 'first-contentful-paint') {
                fcp = Math.round(entry.startTime);
              }
            });
          });
          paintObserver.observe({ type: 'paint', buffered: true });

          var lcpObserver = new PerformanceObserver(function (list) {
            var entries = list.getEntries();
            if (entries.length) {
              var last = entries[entries.length - 1];
              lcp = Math.round(last.startTime);
            }
          });
          lcpObserver.observe({ type: 'largest-contentful-paint', buffered: true });

          window.addEventListener('beforeunload', function () {
            if (window._shubhmayTrack && (fcp || lcp)) {
              window._shubhmayTrack('web_vital', {
                page: 'kundli_preview',
                funnel: 'kundli_preview',
                fcp: fcp,
                lcp: lcp,
                is_lps: location.pathname.indexOf('/lps/') !== -1
              });
            }
          });
        } catch (e) { }
      }
    })();
  </script>
  <!-- GTM: deferred to window.load so FCP/LCP stay fast -->
  <script>
    window.addEventListener('load', function () {
      (function (w, d, s, l, i) {
        w[l] = w[l] || []; w[l].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });
        var f = d.getElementsByTagName(s)[0], j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true; j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
      })(window, document, 'script', 'dataLayer', 'GTM-MGBML6GZ');
    });
  </script>
  <title>Apni Kundli Check Karein | ShubhMay – ज्योतिष</title>
  <meta name="description" content="Apni Kundli Check Karein aur jaane apna future. Vedic astrology analysis – ₹399.">
  <style>
    :root {
      --deep-maroon: #2d080e;
      --dark-maroon: #1f0509;
      --light-maroon: #4d0e19;
      --cream: #fbf9f3;
      --cream-light: #ffffff;
      --matte-gold: #c7a962;
      --dark-gold: #a68a48;
      --saffron: #f29f58;
      --saffron-bright: #ffb873;
      --text-dark: #2a2522;
      --text-muted: #6b635e;
      --text-light: #fefcfb;
      --navy: #2d080e;
      /* Re-using maroon for logic consistency */
      --navy-light: #4d0e19;
      --radius: 14px;
      --radius-lg: 20px;
      --font-display: 'Outfit', sans-serif;
      --font-body: 'Inter', -apple-system, sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-body);
      color: var(--text-dark);
      background-color: var(--dark-maroon);
      background-image: radial-gradient(circle at top right, var(--light-maroon), var(--dark-maroon) 70%);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    .page-content {
      position: relative;
      z-index: 1;
      min-height: 100vh;
      padding-bottom: 48px;
    }

    /* Navbar */
    .navbar {
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(180deg, var(--deep-maroon) 0%, var(--dark-maroon) 100%);
      backdrop-filter: blur(12px);
      border-bottom: 2px solid var(--light-maroon);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .navbar-inner {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .om-symbol {
      font-size: 1.8rem;
      color: var(--matte-gold);
      animation: omPulse 4s ease-in-out infinite;
    }

    @keyframes omPulse {

      0%,
      100% {
        opacity: 0.8;
      }

      50% {
        opacity: 1;
        filter: drop-shadow(0 0 8px rgba(199, 169, 98, 0.5));
      }
    }

    .navbar-logo {
      height: 36px;
    }

    .navbar-title {
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--cream);
      letter-spacing: 0.02em;
    }

    .navbar-sub {
      font-size: 0.7rem;
      color: var(--matte-gold);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      margin-top: 1px;
    }

    .lang-select {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      display: flex;
      gap: 4px;
    }

    .lang-btn {
      padding: 6px 10px;
      font-size: 0.75rem;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.5);
      background: transparent;
      color: white;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.2s, border-color 0.2s;
    }

    .lang-btn:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .lang-btn.active {
      background: rgba(255, 255, 255, 0.3);
      border-color: white;
    }

    .kundli-chart-wrapper {
      text-align: center;
      margin: 16px 0 24px;
    }

    .main {
      max-width: 440px;
      margin: 0 auto;
      padding: 20px 16px 48px;
    }

    @media (min-width: 420px) {
      .main {
        padding: 28px 20px 56px;
      }
    }

    .panel {
      display: none;
    }

    .panel.visible {
      display: block;
      animation: panelIn 0.6s ease forwards;
    }

    @keyframes panelIn {
      from {
        opacity: 0;
        transform: translateY(24px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Card base – astrology themed */
    .card {
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.97) 0%, rgba(254, 252, 232, 0.95) 100%);
      border-radius: var(--radius-lg);
      padding: 24px 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(251, 191, 36, 0.25);
      box-shadow: 0 4px 24px rgba(0, 0, 0, 0.2), 0 0 0 1px rgba(251, 191, 36, 0.08);
      position: relative;
      overflow: hidden;
    }

    .card.form-card {
      padding: 24px 18px;
    }

    @media (min-width: 420px) {
      .card {
        padding: 32px 24px;
      }

      .card.form-card {
        padding: 28px 24px;
      }
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--gold-dark), var(--saffron), var(--gold-bright));
      border-radius: var(--radius-lg) var(--radius-lg) 0 0;
    }

    .card-shimmer {
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(105deg, transparent 40%, rgba(251, 191, 36, 0.06) 50%, transparent 60%);
      animation: shimmer 8s ease-in-out infinite;
      pointer-events: none;
    }

    @keyframes shimmer {
      0% {
        transform: translateX(-100%) rotate(15deg);
      }

      100% {
        transform: translateX(100%) rotate(15deg);
      }
    }

    /* Form section – mobile-first */
    .step-indicator {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--gold-dark);
      margin-bottom: 16px;
      text-align: center;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .form-hero {
      text-align: center;
      margin-bottom: 24px;
    }

    .form-hero .zodiac-icon {
      font-size: 2.5rem;
      margin-bottom: 12px;
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-6px);
      }
    }

    .form-hero h1 {
      font-family: var(--font-display);
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--navy);
      margin-bottom: 6px;
      line-height: 1.3;
    }

    .form-hero p {
      font-size: 0.9rem;
      color: var(--text-muted);
      line-height: 1.5;
    }

    .form-section {
      margin-bottom: 24px;
    }

    .form-section-title {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--gold-dark);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-section-title::before {
      content: '';
      width: 4px;
      height: 14px;
      background: linear-gradient(180deg, var(--saffron), var(--gold-bright));
      border-radius: 2px;
    }

    .info-banner {
      background: linear-gradient(135deg, rgba(30, 58, 95, 0.06) 0%, rgba(180, 83, 9, 0.05) 100%);
      border: 1px solid rgba(30, 58, 95, 0.12);
      border-radius: 12px;
      padding: 12px 14px;
      margin-bottom: 20px;
      font-size: 0.82rem;
      color: var(--navy);
      line-height: 1.5;
    }

    .info-banner strong {
      color: var(--gold-dark);
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group label {
      display: block;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--navy);
      margin-bottom: 6px;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      padding: 16px 18px;
      min-height: 48px;
      border: 1px solid rgba(180, 83, 9, 0.2);
      border-radius: 12px;
      font-size: 1rem;
      background: var(--white);
      transition: border-color 0.2s, box-shadow 0.2s;
      -webkit-appearance: none;
      appearance: none;
    }

    .form-group select {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2392400e' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
      padding-right: 40px;
    }

    .form-group input:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--saffron);
      box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.12);
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
    }

    .form-row-2 {
      grid-template-columns: 1fr 1fr;
    }

    @media (max-width: 360px) {
      .form-row {
        grid-template-columns: 1fr 1fr;
      }

      .form-row .form-group:last-child {
        grid-column: 1 / -1;
      }
    }

    /* iOS Safari – use native selects to avoid glitches */
    @supports (-webkit-touch-callout: none) {
      .form-group select {
        -webkit-appearance: menulist;
        appearance: menulist;
        background-image: none;
        padding-right: 16px;
      }
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      padding: 18px 24px;
      font-size: 1.05rem;
      font-weight: 600;
      font-family: var(--font-body);
      color: #78350f;
      background: linear-gradient(135deg, #d97706 0%, #f59e0b 50%, #fbbf24 100%);
      background-size: 200% 200%;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      -webkit-tap-highlight-color: transparent;
      animation: btnGlow 3s ease-in-out infinite;
    }

    @keyframes btnGlow {

      0%,
      100% {
        box-shadow: 0 4px 20px rgba(217, 119, 6, 0.35);
      }

      50% {
        box-shadow: 0 6px 28px rgba(251, 191, 36, 0.45);
      }
    }

    .btn:hover {
      transform: translateY(-2px);
    }

    .btn:active {
      transform: translateY(0);
    }

    /* Preview sections */
    .preview-header {
      text-align: left;
      margin-bottom: 24px;
      padding: 16px 18px 14px;
      border-radius: 14px;
      background: radial-gradient(circle at top left, rgba(251, 191, 36, 0.18), rgba(255, 255, 255, 0.95));
      border: 1px solid rgba(180, 83, 9, 0.18);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }

    .preview-header h1,
    .preview-header h2 {
      font-family: var(--font-display);
      font-size: 1.4rem;
      color: var(--navy);
      margin-bottom: 4px;
      letter-spacing: 0.01em;
    }

    .preview-header p {
      font-size: 0.82rem;
      color: var(--text-muted);
      line-height: 1.5;
      margin-bottom: 6px;
    }

    .preview-meta-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px 14px;
      margin-top: 6px;
      font-size: 0.78rem;
      color: var(--navy-light);
    }

    .preview-meta-pill {
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(45, 8, 14, 0.05);
      border: 1px solid rgba(180, 83, 9, 0.18);
      font-weight: 500;
    }

    /* Section cards – unique styles */
    .sec-card {
      background: var(--white);
      border-radius: var(--radius);
      padding: 20px 22px;
      margin-bottom: 16px;
      border: 1px solid rgba(180, 83, 9, 0.12);
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.04);
      animation: cardReveal 0.5s ease backwards;
    }

    .sec-card:nth-child(1) {
      animation-delay: 0.1s;
    }

    .sec-card:nth-child(2) {
      animation-delay: 0.2s;
    }

    .sec-card:nth-child(3) {
      animation-delay: 0.3s;
    }

    .sec-card:nth-child(4) {
      animation-delay: 0.4s;
    }

    .sec-card:nth-child(5) {
      animation-delay: 0.5s;
    }

    @keyframes cardReveal {
      from {
        opacity: 0;
        transform: translateY(16px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .sec-head {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 14px;
    }

    .sec-head .icon {
      width: 36px;
      height: 36px;
      background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(251, 191, 36, 0.15));
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
    }

    .sec-head h2 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--navy);
    }

    .sec-card p {
      font-size: 0.95rem;
      line-height: 1.65;
      color: var(--text-dark);
    }

    .video-section {
      margin-top: 8px;
      border-radius: 18px;
      overflow: hidden;
      border: 1px solid rgba(15, 23, 42, 0.3);
      background: #020617;
      width: calc(100% + 12px);
      margin-left: -6px;
      margin-right: -6px;
    }

    .video-iframe {
      width: 100%;
      aspect-ratio: 1 / 1;
      border: none;
      display: block;
    }

    .testimonial-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;
      margin-top: 4px;
    }

    .testimonial-card {
      background: #f9fafb;
      border-radius: 10px;
      padding: 12px 14px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      font-size: 0.88rem;
      line-height: 1.5;
      color: var(--text-dark);
    }

    .testimonial-name {
      margin-top: 6px;
      font-weight: 600;
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    @media (min-width: 460px) {
      .testimonial-grid {
        grid-template-columns: 1fr 1fr;
      }
    }

    .trust-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }

    @media (min-width: 640px) {
      .trust-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .trust-item {
      flex: 1;
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: linear-gradient(145deg, #f9fafb, #ffffff);
    }

    .trust-icon {
      width: 30px;
      height: 30px;
      border-radius: 999px;
      background: rgba(22, 163, 74, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #16a34a;
    }

    .trust-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--navy);
      margin-bottom: 2px;
    }

    .trust-copy {
      font-size: 0.8rem;
      line-height: 1.5;
      color: var(--text-muted);
    }

    .trait-list {
      list-style: none;
      margin-top: 14px;
    }

    .trait-list li {
      padding: 12px 16px;
      background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 0%, rgba(251, 191, 36, 0.08) 100%);
      border-radius: 10px;
      margin-bottom: 10px;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 12px;
      border-left: 3px solid var(--saffron);
      animation: traitIn 0.4s ease backwards;
    }

    .trait-list li:nth-child(1) {
      animation-delay: 0.15s;
    }

    .trait-list li:nth-child(2) {
      animation-delay: 0.25s;
    }

    @keyframes traitIn {
      from {
        opacity: 0;
        transform: translateX(-8px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .trait-list li::before {
      content: '✦';
      color: var(--saffron);
      font-weight: 700;
    }

    /* Fear / alert card - upgraded to Critical Blockage */
    .critical-blockage-box {
      background: linear-gradient(135deg, rgba(185, 28, 28, 0.08) 0%, rgba(239, 68, 68, 0.05) 100%);
      border: 2px dashed #e55a5a;
      border-radius: var(--radius-lg);
      padding: 24px 22px;
      margin: 20px 0;
      text-align: center;
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 0 30px rgba(229, 90, 90, 0.1);
    }

    .critical-blockage-box .icon-wrap {
      width: 56px;
      height: 56px;
      background: rgba(185, 28, 28, 0.15);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      margin: 0 auto 16px;
      animation: alertPulse 2s ease-in-out infinite;
      box-shadow: 0 0 15px rgba(229, 90, 90, 0.4);
    }

    @keyframes alertPulse {

      0%,
      100% {
        transform: scale(1);
        box-shadow: 0 0 15px rgba(229, 90, 90, 0.4);
      }

      50% {
        transform: scale(1.1);
        box-shadow: 0 0 25px rgba(229, 90, 90, 0.6);
      }
    }

    .critical-blockage-box h3 {
      color: #b91c1c;
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 12px;
      font-family: var(--font-display);
      letter-spacing: 0.02em;
      text-transform: uppercase;
    }

    .critical-blockage-box p {
      color: #991b1b;
      font-size: 0.95rem;
      line-height: 1.65;
      margin-bottom: 16px;
    }

    .critical-blockage-box strong {
      color: #7f1d1d;
    }

    .critical-blockage-box .action-text {
      color: #b91c1c;
      font-size: 0.9rem;
      font-weight: 600;
      text-decoration: underline;
    }

    /* Escalation card */
    .escalation-card {
      background: linear-gradient(135deg, rgba(30, 58, 95, 0.06) 0%, rgba(180, 83, 9, 0.05) 100%);
      border: 1px solid rgba(180, 83, 9, 0.2);
      border-left: 4px solid var(--saffron);
      border-radius: var(--radius);
      padding: 16px 20px;
      font-size: 0.95rem;
      color: var(--navy);
      font-weight: 500;
      line-height: 1.5;
      margin-bottom: 32px;
    }

    /* Blur blocks */
    .blur-grid {
      display: grid;
      gap: 12px;
      margin: 20px 0;
    }

    .locked-block {
      height: auto;
      min-height: 64px;
      padding: 12px 16px;
      background: #fef2f2;
      border: 1px solid #fecaca;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      justify-content: center;
      gap: 4px;
      border-radius: var(--radius);
    }

    .locked-block .locked-title {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .locked-block .locked-title span {
      font-size: 0.95rem;
      font-weight: 600;
      color: #7f1d1d;
    }

    .locked-block .locked-sub {
      font-size: 0.75rem;
      color: #b91c1c;
      margin-left: 24px;
    }

    .deliverable-block {
      height: 64px;
      background: linear-gradient(135deg, rgba(30, 58, 95, 0.04) 0%, rgba(180, 83, 9, 0.04) 100%);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 0 16px;
      border: 1px solid rgba(180, 83, 9, 0.15);
      position: relative;
      overflow: hidden;
      gap: 12px;
    }

    .deliverable-block span {
      font-size: 0.9rem;
      color: var(--text-dark);
      font-weight: 500;
      z-index: 1;
    }

    /* Progress */
    .progress-card {
      background: linear-gradient(135deg, rgba(30, 58, 95, 0.08), rgba(245, 158, 11, 0.08));
      border-radius: var(--radius);
      padding: 22px 24px;
      margin: 24px 0;
      border: 1px solid rgba(180, 83, 9, 0.2);
    }

    .progress-bar-wrap {
      height: 14px;
      background: rgba(180, 83, 9, 0.15);
      border-radius: 14px;
      overflow: hidden;
      margin-bottom: 14px;
    }

    .progress-fill {
      height: 100%;
      width: 40%;
      background: linear-gradient(90deg, var(--gold-dark), var(--saffron), var(--gold-bright));
      border-radius: 14px;
      animation: progressPulse 2s ease-in-out infinite;
    }

    @keyframes progressPulse {

      0%,
      100% {
        opacity: 0.95;
      }

      50% {
        opacity: 1;
      }
    }

    .progress-text {
      font-size: 0.9rem;
      color: var(--text-muted);
      text-align: center;
      font-weight: 500;
    }

    /* Offer card */
    .offer-card {
      background: linear-gradient(145deg, #fff 0%, #fefce8 50%, #fef9c3 100%);
      border: 2px solid rgba(180, 83, 9, 0.25);
      border-radius: var(--radius-lg);
      padding: 28px 24px;
      margin-top: 24px;
      text-align: center;
      position: relative;
      overflow: hidden;
      animation: offerFloat 5s ease-in-out infinite;
    }

    @keyframes offerFloat {

      0%,
      100% {
        transform: translateY(0);
      }

      50% {
        transform: translateY(-4px);
      }
    }

    .offer-card::before {
      content: '✦ ✦ ✦';
      position: absolute;
      top: 12px;
      left: 0;
      right: 0;
      font-size: 0.75rem;
      color: rgba(180, 83, 9, 0.4);
      letter-spacing: 0.5em;
    }

    .price-row {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin: 20px 0 24px;
      flex-wrap: wrap;
    }

    .price-old {
      font-size: 1.2rem;
      color: var(--text-muted);
      text-decoration: line-through;
    }

    .price-new {
      font-size: 1.8rem;
      font-weight: 700;
      font-family: var(--font-display);
      color: var(--gold-dark);
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }

    .unlock-cta {
      width: 100%;
      padding: 18px 24px;
      font-size: 1.05rem;
      animation: btnGlow 3s ease-in-out infinite;
    }

    /* What you get – info strip */
    .info-strip {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      margin: 20px 0 0;
      padding-top: 20px;
      border-top: 1px dashed rgba(180, 83, 9, 0.2);
    }

    .info-chip {
      padding: 8px 14px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.02em;
      color: #92400e;
      background: #fef3c7;
      border: 1px solid rgba(180, 83, 9, 0.4);
    }

    .skip-cta {
      display: block;
      margin-top: 20px;
      font-size: 0.9rem;
      color: var(--text-muted);
      text-decoration: underline;
      cursor: pointer;
      background: none;
      border: none;
      padding: 0;
    }

    .skip-cta:hover {
      color: var(--gold-dark);
    }

    .scarcity-badge {
      display: inline-block;
      padding: 6px 12px;
      background: rgba(34, 197, 94, 0.15);
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      color: #15803d;
      margin-bottom: 12px;
    }

    /* Sticky Bar Additions */

    .sticky-cta-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, rgba(45, 8, 14, 0.98), rgba(77, 14, 25, 0.98));
      padding: 10px 14px;
      box-shadow: 0 -8px 26px rgba(0, 0, 0, 0.75);
      z-index: 200;
      display: none;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      border-top: 1px solid rgba(199, 169, 98, 0.5);
    }

    .sticky-cta-bar.show {
      display: flex;
      animation: slideUp 0.4s ease forwards;
    }

    @keyframes slideUp {
      from {
        transform: translateY(100%);
      }

      to {
        transform: translateY(0);
      }
    }

    .sticky-bar-text {
      color: var(--cream);
      text-align: left;
      font-size: 0.8rem;
      line-height: 1.3;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .sticky-bar-text strong {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.94rem;
      color: var(--saffron-bright);
      font-weight: 700;
    }

    .sticky-bar-text strong::before {
      content: '⚠';
      font-size: 0.95rem;
    }

    .sticky-bar-sub {
      font-size: 0.76rem;
      color: rgba(248, 250, 252, 0.9);
      opacity: 0.9;
    }

    .sticky-bar-btn {
      background: linear-gradient(135deg, var(--saffron-bright), var(--matte-gold));
      color: var(--navy);
      padding: 8px 16px;
      border: none;
      border-radius: 999px;
      font-weight: 700;
      font-size: 0.9rem;
      cursor: pointer;
      animation: btnPulse 2s infinite;
      white-space: nowrap;
    }

    .sticky-price-old {
      text-decoration: line-through;
      font-size: 0.8rem;
      opacity: 0.8;
      margin-right: 4px;
    }

    .sticky-price-new {
      font-size: 0.96rem;
      font-weight: 700;
    }

    @keyframes btnPulse {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }

      100% {
        transform: scale(1);
      }
    }

    /* Kundli checking loader – full-screen overlay */
    .kundli-loader-overlay {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: radial-gradient(circle at top, rgba(45, 8, 14, 0.97), rgba(31, 5, 9, 0.98));
      display: none;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 24px;
      color: #fef3c7;
    }

    .kundli-loader-overlay.visible {
      display: flex !important;
    }

    .kundli-loader-inner {
      max-width: 360px;
    }

    .kundli-loader-wheel {
      width: 72px;
      height: 72px;
      margin: 0 auto 20px;
      border-radius: 50%;
      border: 3px solid rgba(251, 191, 36, 0.2);
      border-top-color: var(--matte-gold);
      border-right-color: var(--saffron);
      animation: kundliLoaderSpin 1.2s linear infinite;
      box-shadow: 0 0 24px rgba(199, 169, 98, 0.4);
    }

    .kundli-loader-title {
      font-family: var(--font-display);
      font-size: 0.95rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      margin-bottom: 10px;
      color: #fde68a;
    }

    .kundli-loader-line {
      font-size: 0.9rem;
      color: #fde68a;
      min-height: 48px;
      line-height: 1.5;
    }

    @keyframes kundliLoaderSpin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MGBML6GZ" height="0" width="0"
      style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  <!-- Full-screen loader when "Check Kundli" is clicked -->
  <div class="kundli-loader-overlay" id="kundliLoader" aria-hidden="true" role="status" aria-live="polite">
    <div class="kundli-loader-inner">
      <div class="kundli-loader-wheel" aria-hidden="true"></div>
      <div class="kundli-loader-title">Checking kundli…</div>
      <div class="kundli-loader-line" id="kundliLoaderLine">Graho ki position analyse ho rahi hai…</div>
    </div>
  </div>

  <div class="page-content">
    <header class="navbar">
      <div class="navbar-inner"
        style="width: 100%; max-width: 440px; position: relative; justify-content: flex-start; padding-left: 16px;">
        <span class="om-symbol">ॐ</span>
        <div>
          <div class="navbar-title">ShubhMay</div>
          <div class="navbar-sub">Jyotish & Kundli</div>
        </div>
        <div class="lang-select">
          <button type="button" class="lang-btn active" data-lang="hinglish">Hinglish</button>
          <button type="button" class="lang-btn" data-lang="hi">हिंदी</button>
          <button type="button" class="lang-btn" data-lang="en">English</button>
        </div>
      </div>
    </header>

    <main class="main">
      <!-- Step 1: Form – mobile-first -->
      <section class="panel visible" id="formPanel">
        <div class="card form-card">
          <div class="card-shimmer"></div>
          <p class="step-indicator" data-i18n="step1Ind">Step 1 of 2</p>
          <div class="form-hero">
            <div class="zodiac-icon">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" style="color:var(--saffron);">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
              </svg>
            </div>
            <h1 data-i18n="h1Title">Check your Kundali</h1>
            <p data-i18n="h1Sub">Birth chart se apna sachha future aur kundli details dekhen.</p>
          </div>
          <form id="kundliForm">
            <div class="form-section">
              <div class="form-section-title" data-i18n="secName">Name & Gender</div>
              <div class="form-row-2">
                <div class="form-group">
                  <label for="name" data-i18n="lblName">Aapka naam</label>
                  <input type="text" id="name" required placeholder="e.g. Rahul" autocomplete="name"
                    data-i18n="lblName">
                </div>
                <div class="form-group">
                  <label for="gender" data-i18n="lblGender">Gender</label>
                  <select id="gender" required>
                    <option value="" data-i18n="selGen">Select</option>
                    <option value="Male" data-i18n="genM">Male</option>
                    <option value="Female" data-i18n="genF">Female</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-section">
              <div class="form-section-title" data-i18n="secDob">Date of Birth</div>
              <div class="form-row">
                <div class="form-group">
                  <label for="dobDay" data-i18n="lblDay">Day</label>
                  <select id="dobDay" required>
                    <option value="">DD</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="dobMonth" data-i18n="lblMonth">Month</label>
                  <select id="dobMonth" required>
                    <option value="">MM</option>
                    <option value="01">Jan</option>
                    <option value="02">Feb</option>
                    <option value="03">Mar</option>
                    <option value="04">Apr</option>
                    <option value="05">May</option>
                    <option value="06">Jun</option>
                    <option value="07">Jul</option>
                    <option value="08">Aug</option>
                    <option value="09">Sep</option>
                    <option value="10">Oct</option>
                    <option value="11">Nov</option>
                    <option value="12">Dec</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="dobYear" data-i18n="lblYear">Year</label>
                  <select id="dobYear" required>
                    <option value="">YYYY</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-section">
              <div class="form-section-title" data-i18n="secTimePlace">Time & Place</div>

              <div class="form-group" style="margin-bottom:12px;">
                <label data-i18n="lblTime">Birth Time</label>
                <div class="form-row">
                  <div class="form-group" style="margin-bottom:0;">
                    <select id="tobHour" required>
                      <option value="">HH</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin-bottom:0;">
                    <select id="tobMin" required>
                      <option value="">MM</option>
                    </select>
                  </div>
                  <div class="form-group" style="margin-bottom:0;">
                    <select id="tobAmPm" required>
                      <option value="">AM/PM</option>
                      <option value="AM">AM</option>
                      <option value="PM">PM</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="form-group">
                <label for="place" data-i18n="lblPlace">Birth Place</label>
                <input type="text" id="place" required placeholder="e.g. Mumbai" autocomplete="off"
                  data-i18n="lblPlace">
              </div>
            </div>
            <div class="info-banner">
              <strong data-i18n="infoWhy">Why needed?</strong> <span data-i18n="infoDesc">Date, time & place se exact
                grah positions calculate hote hain.</span>
            </div>
            <button type="submit" class="btn" id="btnGenerate" data-i18n="btnCheck">Check Kundli</button>
          </form>
        </div>
        <div class="info-strip">
          <span class="info-chip" data-i18n="chip1">100% Free Check</span>
          <span class="info-chip" data-i18n="chip2">Vedic Method</span>
          <span class="info-chip" data-i18n="chip3">2 min</span>
        </div>
      </section>

      <!-- Step 2: Preview Result -->
      <section class="panel" id="previewPanel">
        <div class="card">
          <div class="card-shimmer"></div>

          <!-- 1. TOP STATUS STRIP -->
          <div class="preview-header">
            <h2 data-i18n="pHead">
              Basic Kundali Report
            </h2>
            <p data-i18n="pStatSub">
              Yah sirf aapki janam kundli ka upar‑upar se ek chhota sa preview hai. Asli vistrit report hamare jyotishi
              manually dekh kar banate hain.
            </p>
            <div class="preview-meta-row">
              <span class="preview-meta-pill">Preview snapshot – full report abhi locked hai</span>
              <span class="preview-meta-pill">Birth details based auto‑analysis</span>
            </div>
          </div>

          <!-- 2. SHORT POSITIVE OPENING – structured like report -->
          <div class="sec-card" style="margin-top:24px; padding: 16px;">
            <div style="font-size:0.8rem; text-transform:uppercase; letter-spacing:0.09em; color:var(--text-muted); margin-bottom:6px;">
              Career & personality snapshot
            </div>
            <p id="identityText" style="font-weight:600; font-size: 0.95rem; color: var(--navy); line-height:1.55;"></p>
            <ul class="trait-list" id="traitsList" style="margin-top: 12px; font-size: 0.9rem;"></ul>
          </div>

          <!-- 3. TENSION BLOCK (KATHIN YOG) -->
          <div class="critical-blockage-box" style="background: #fef2f2; border-color: #fecaca; margin-top: 16px;">
            <div class="icon-wrap" style="color:#b91c1c;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z">
                </path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
              </svg>
            </div>
            <h3 data-i18n="doshTitle" style="color: #b91c1c; font-size:1.05rem; margin-bottom:8px;">⚠ Strong Negative
              Yog Detected</h3>
            <p style="font-size:0.9rem; color:#7f1d1d; line-height:1.5;" data-i18n="doshSub">Kundli me ek aisa
              grah-sanyog dikh raha hai jo career aur financial growth me rukavat create kar sakta hai. Agar is yog ko
              samay par samjha na jaye toh progress delay ho sakti hai.</p>
          </div>

          <!-- 4. KATHIN YOG EXPLAINER VIDEO -->
          <div class="sec-card" style="margin-top: 18px;">
            <div class="sec-head">
              <span class="icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--navy)" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
              </span>
              <h2>Iss video ko jarur dekhein</h2>
            </div>
            <div class="video-section">
              <iframe class="video-iframe" title="Kathin yog video"
                src="https://player.mediadelivery.net/embed/550381/2a2bf641-1191-4b83-98b5-dc37a5184255"
                loading="lazy" allow="accelerometer; encrypted-media; gyroscope; picture-in-picture; fullscreen"
                allowfullscreen referrerpolicy="no-referrer-when-downgrade"></iframe>
            </div>
          </div>

          <!-- 5. SELF-VALIDATION TRIGGER -->
          <div class="escalation-card"
            style="background: rgba(180, 83, 9, 0.05); border-left: 3px solid var(--saffron); border-radius: 4px; padding: 12px 16px; margin: 16px 0;">
            <strong data-i18n="valTrig" style="color: var(--navy); font-size:0.95rem; display:block;">Kya aapne pichle
              1–2 saal me delay, pressure ya unexpected rukavat feel ki hai?</strong>
            <p data-i18n="valYes"
              style="margin-top:8px; font-size:0.85rem; color:var(--text-muted); line-height:1.45;">
              Agar haan, toh aapko apni personalized kundli report banwani chahiye.
            </p>
          </div>

          <!-- 7. VALUE STACK SECTION -->
          <div class="sec-card">
            <div class="sec-head">
              <span class="icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--gold-dark)" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
              </span>
              <h2 data-i18n="lockTitle">What You'll Unlock in Your Detailed Personalized Kundli Report</h2>
            </div>

            <img src="/assets/premium_kundli.webp" alt="Premium Kundli Report"
              style="width: 100%; border-radius: var(--radius); margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid rgba(180, 83, 9, 0.2);">

            <div class="blur-grid" style="margin:0;">
              <div class="deliverable-block" style="margin-bottom:12px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="green" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span data-i18n="v1">Complete Dosha & Dasha Breakdown</span>
              </div>
              <div class="deliverable-block" style="margin-bottom:12px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="green" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span data-i18n="v2">Exact Severity Analysis</span>
              </div>
              <div class="deliverable-block" style="margin-bottom:12px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="green" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span data-i18n="v3">Personalized Remedies (Easy-to-follow)</span>
              </div>
              <div class="deliverable-block" style="margin-bottom:12px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="green" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span data-i18n="v4">Lucky Metal & Timing Guidance</span>
              </div>
              <div class="deliverable-block" style="margin-bottom:12px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="green" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span data-i18n="v5">Career & Wealth Roadmap</span>
              </div>
              <div class="deliverable-block" style="margin-bottom:12px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="green" stroke-width="2">
                  <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
                <span data-i18n="v6">12-Month Forecast</span>
              </div>
            </div>
          </div>

          <!-- 8, 9, 10: SCARCITY + CAPACITY, PRICING, PRIMARY CTA -->
          <div class="offer-card" style="margin-top: 24px;">
            <div
              style="font-size:0.85rem; font-weight:600; color:#b91c1c; margin-bottom:12px; display:inline-block; background:rgba(239, 68, 68, 0.1); padding:6px 12px; border-radius:20px;"
              data-i18n="scarLimit">
              Today’s manual analysis capacity is almost full.
            </div>
            <p style="font-size:0.85rem; color:var(--text-muted); margin-bottom:12px;" data-i18n="offSub">Limited-time
              offer – 73% off</p>
            <div class="price-row" style="margin-bottom: 20px;">
              <span class="price-old">₹1499</span>
              <span class="price-new">₹399</span>
            </div>
            <button type="button" class="btn unlock-cta" id="btnUnlock" data-i18n="btnUnlock"
              style="background:var(--saffron); color:white;">Get My Exact Lucky Metal & Full Kundli – ₹399</button>
            <button type="button" class="skip-cta" id="btnSkipPreview" data-i18n="btnSkip">Directly go to
              checkout</button>
          </div>

          <!-- 6. LOCKED PREVIEW BLOCK (MOVED BELOW UPSELL FOR LP) -->
          <div class="sec-card" style="margin-top: 18px; margin-bottom: 24px;">
            <div
              style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:12px;">
              <h3 data-i18n="notBasicHead"
                style="font-family: var(--font-display); font-size: 1.05rem; color: var(--navy); margin:0;">
                What not in basic kundali
              </h3>
              <span
                style="font-size:0.78rem; color: var(--text-muted); background: rgba(180,83,9,0.06); border:1px solid rgba(180,83,9,0.12); padding:4px 10px; border-radius:999px;"
                data-i18n="notBasicTag">Locked</span>
            </div>
            <div class="blur-grid" style="margin:0;">
              <div class="locked-block">
                <div class="locked-title">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  <span data-i18n="lbl1">Exact Dosha Name</span>
                </div>
                <div class="locked-sub" data-i18n="lblVer">Need astrologer manual verification</div>
              </div>
              <div class="locked-block">
                <div class="locked-title">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  <span data-i18n="lbl2">Severity Level</span>
                </div>
                <div class="locked-sub" data-i18n="lblVer">Need astrologer manual verification</div>
              </div>
              <div class="locked-block">
                <div class="locked-title">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  <span data-i18n="lbl3">Grah Impact Area</span>
                </div>
                <div class="locked-sub" data-i18n="lblVer">Need astrologer manual verification</div>
              </div>
              <div class="locked-block">
                <div class="locked-title">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  <span data-i18n="lbl4">Lucky Metal (Birth Chart Based)</span>
                </div>
                <div class="locked-sub" data-i18n="lblVer">Need astrologer manual verification</div>
              </div>
              <div class="locked-block">
                <div class="locked-title">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  <span data-i18n="lbl5">Effective Remedies & Timing</span>
                </div>
                <div class="locked-sub" data-i18n="lblVer">Need astrologer manual verification</div>
              </div>
              <div class="locked-block">
                <div class="locked-title">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#dc2626" stroke-width="2.5">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                  <span data-i18n="lbl6">1-Year Risk Timeline</span>
                </div>
                <div class="locked-sub" data-i18n="lblVer">Need astrologer manual verification</div>
              </div>
            </div>
          </div>

          <!-- SOCIAL PROOF NEAR RESULT CTA -->
          <div class="sec-card" style="margin-top: 18px;">
            <div class="sec-head">
              <span class="icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--navy)" stroke-width="2">
                  <circle cx="9" cy="7" r="3"></circle>
                  <path d="M15 11c1.38 0 2.5-1.12 2.5-2.5S16.38 6 15 6"></path>
                  <path d="M4 21v-1.5C4 16.57 6.57 14 9.5 14h1"></path>
                  <path d="M17.5 14.5c1.86.5 3.5 2.1 3.5 4V21"></path>
                </svg>
              </span>
              <h2>Jinko is report se real fayda mila</h2>
            </div>
            <div class="testimonial-grid">
              <div class="testimonial-card">
                <p>“Job me 8 mahine se promotion rukha hua tha. Report ke baad jo remedies bataye, 3–4 mahine me finally
                    growth mili.”</p>
                <div class="testimonial-name">— Rohan (28), Bengaluru</div>
              </div>
              <div class="testimonial-card">
                <p>“Financial stress ka phase chal raha tha. Lucky metal aur timing follow karne se expenses control me
                    aaye aur savings wapas build hue.”</p>
                <div class="testimonial-name">— Neha (32), Delhi</div>
              </div>
            </div>
          </div>

          <!-- TRUST & SAFETY SECTION FOR LP VISITORS -->
          <div class="sec-card" style="margin-top: 14px;">
            <div class="sec-head">
              <span class="icon">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--navy)" stroke-width="2">
                  <path d="M12 2l7 4v5c0 5-3.5 9.5-7 11-3.5-1.5-7-6-7-11V6z"></path>
                  <path d="M9 12l2 2 4-4"></path>
                </svg>
              </span>
              <h2>Safe, private aur trusted vedic process</h2>
            </div>
            <div class="trust-grid">
              <div class="trust-item">
                <div class="trust-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="10" rx="2" ry="2"></rect>
                    <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                  </svg>
                </div>
                <div class="trust-copy">
                  <div class="trust-label">Data 100% private</div>
                  <p>Kundli details sirf hamari jyotish team dekhti hai – kisi third‑party app, tool ya ads platform ke
                      saath share nahi hota.</p>
                </div>
              </div>
              <div class="trust-item">
                <div class="trust-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 1l3 5.5 6 .9-4.3 4.2L17.7 19 12 16.2 6.3 19l1-7.4L3 7.4l6-.9z"></path>
                  </svg>
                </div>
                <div class="trust-copy">
                  <div class="trust-label">Manual vedic analysis</div>
                  <p>Report kisi generic app se auto‑generate nahi hoti; experienced jyotishi aapki exact birth details ke
                      hisaab se manually chart analyse karke likhte hain.</p>
                </div>
              </div>
              <div class="trust-item">
                <div class="trust-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 5h18"></path>
                    <path d="M3 10h18"></path>
                    <path d="M3 15h18"></path>
                    <path d="M7 20h10"></path>
                  </svg>
                </div>
                <div class="trust-copy">
                  <div class="trust-label">Fast delivery assurance</div>
                  <p>Detailed personalized report aapko WhatsApp + Email par bheji jati hai, generally 24–48 ghanton ke
                      andar – taki aap delay ke bina action le saken.</p>
                </div>
              </div>
            </div>
          </div>

          <!-- HUMAN REVIEW EXPLANATION (near upsell) -->
          <div class="info-banner"
            style="background: #f8fafc; border: 1px solid #e2e8f0; color: #334155; text-align: left; border-radius: 8px; font-size:0.85rem; padding: 16px; margin-top: 14px;">
            <strong style="color: #0f172a; display:block; margin-bottom:4px; font-size:0.95rem;" data-i18n="hrHead">🧿
              Kaise taiyar hoti hai report?</strong>
            <span data-i18n="hrDesc" style="display:block; margin-bottom:6px; line-height:1.5;">Detailed kundli report
              hamare jyotishi manually banate hain — graho ke kathin yog, dasha timing aur aapke liye safe remedies sab
              clearly explain kiye jaate hain.</span>
            <strong data-i18n="hrDel" style="font-size:0.85rem; color:#475569; display:block;">Report WhatsApp + Email
              par bheji jati hai – taki aap baar‑baar refer kar saken.</strong>
          </div>
        </div>
      </section>
      <!-- Sticky Urgency Bar -->
      <div class="sticky-cta-bar" id="stickyBar">
        <div class="sticky-bar-text">
          <strong data-i18n="stickHead">Apni personalized kundli banwaye</strong>
        </div>
        <button type="button" class="sticky-bar-btn" id="btnStickyUnlock">
          <span class="sticky-price-old">₹1499</span>
          <span class="sticky-price-new">₹399</span>
        </button>
      </div>

  </div>

  <script>
    (function () {
      var CHECKOUT_URL = 'https://superprofile.bio/vp/kundli-checkout';
      function populateDropdown(id, start, end, pad) {
        var el = document.getElementById(id);
        if (!el) return;
        var step = (id === 'tobMin') ? 5 : 1;
        if (start < end) {
          for (var i = start; i <= end; i += step) {
            var val = (pad && i < 10) ? '0' + i : i.toString();
            var opt = document.createElement('option');
            opt.value = val;
            opt.textContent = val;
            el.appendChild(opt);
          }
        } else {
          for (var i = start; i >= end; i -= step) {
            var val = (pad && i < 10) ? '0' + i : i.toString();
            var opt = document.createElement('option');
            opt.value = val;
            opt.textContent = val;
            el.appendChild(opt);
          }
        }
      }

      populateDropdown('dobDay', 1, 31, true);
      var yr = new Date().getFullYear();
      populateDropdown('dobYear', yr, yr - 80, false);
      populateDropdown('tobHour', 1, 12, true);
      populateDropdown('tobMin', 0, 59, true);

      var PREVIEW_COPY = {
        hinglish: {
          step1Ind: 'Step 1 of 2',
          h1Title: 'Check your Kundali',
          h1Sub: 'Birth chart se apna sachha future aur kundli details dekhen.',
          secName: 'Name & Gender',
          lblName: 'Aapka naam',
          lblGender: 'Gender',
          selGen: 'Select',
          genM: 'Male',
          genF: 'Female',
          secDob: 'Date of Birth',
          lblDay: 'Day',
          lblMonth: 'Month',
          lblYear: 'Year',
          secTimePlace: 'Time & Place',
          lblTime: 'Birth Time',
          lblPlace: 'Birth Place',
          infoWhy: 'Why needed?',
          infoDesc: 'Date, time & place se exact grah positions calculate hote hain.',
          btnCheck: 'Check Kundli',
          chip1: '100% Free Check',
          chip2: 'Vedic Method',
          chip3: '2 min',
          pStatBadge: '⚡ Instant Grah Scan Completed',
          pStatSub: 'This is an automated surface-level preview based on your birth data.',
          identText: '{name}, aapki janam kundli ke chart me career aur leadership ka strong yog dikh raha hai.',
          doshTitle: '⚠ Aapki kundli me kathin yog ka sanket hai',
          doshSub: 'Kundli me ek aisa grah sanyog dikh raha hai jo career aur paison ki growth me rukavat la sakta hai. Agar is yog ko samay par samjha na jaye toh pragati dheemi ho sakti hai.',
          valTrig: 'Kya aapne pichle 1–2 saal me delay, pressure ya unexpected rukavat feel ki hai?',
          valYes: 'Agar haan, toh aapko apni personalized kundli report banwani chahiye.',
          pHead: 'Basic Kundali Report',
          notBasicHead: 'What not in basic kundali',
          notBasicTag: 'Locked',
          metalHead: '',
          metalSub: '',
          lbl1: 'Exact Dosha Name',
          lbl2: 'Severity Level',
          lbl3: 'Grah Impact Area',
          lbl4: 'Lucky Metal (Birth Chart Based)',
          lbl5: 'Effective Remedies & Timing',
          lbl6: '1-Year Risk Timeline',
          lblVer: 'Needs astrologer manual verification',
          hrHead: '🧿 Kaise taiyar hoti hai report?',
          hrDesc: 'Detailed kundli report hamare jyotishi manually banate hain — grah bal, dasha timing aur upay sab aapke hisaab se check kiya jata hai.',
          hrDel: 'Report WhatsApp + Email par bheji jati hai.',
          lockTitle: 'Detailed Personalized Kundli Report me kya milega',
          v1: 'Aapke dosh aur dasha ka detailed breakdown',
          v2: 'Problem ki exact severity ka clear analysis',
          v3: 'Aapke liye easy aur practical personalized remedies',
          v4: 'Birth chart based exact lucky metal aur timing guidance',
          v5: 'Career aur wealth growth ke liye clear roadmap',
          v6: 'Agle 12 mahino ka focused forecast',
          scarLimit: 'Aaj jyotishi ki manual analysis capacity almost full hai.',
          offSub: 'Limited time ke liye – 73% off',
          btnUnlock: 'Meri Full Kundli Report Unlock karo – ₹399',
          btnSkip: 'Skip karke seedha checkout par jao',
          stickHead: 'Apni personalized kundli banwaye',
          stickSub: '',
          btnSticky: 'Unlock – ₹399'
        },
        hi: {
          step1Ind: 'स्टेप 1',
          h1Title: 'अपनी कुंडली चेक करें',
          h1Sub: 'अपनी जन्म कुंडली से अपना असली भविष्य और विवरण जानें।',
          secName: 'नाम और लिंग',
          lblName: 'आपका नाम',
          lblGender: 'लिंग',
          selGen: 'चुनें',
          genM: 'पुरुष',
          genF: 'महिला',
          secDob: 'जन्म तिथि',
          lblDay: 'दिन',
          lblMonth: 'महीना',
          lblYear: 'वर्ष',
          secTimePlace: 'समय व स्थान',
          lblTime: 'जन्म समय',
          lblPlace: 'जन्म स्थान',
          infoWhy: 'क्यों जरूरी है?',
          infoDesc: 'तारीख, समय और स्थान से सटीक ग्रह स्थिति की गणना होती है।',
          btnCheck: 'कुंडली चेक करें',
          chip1: '100% फ्री चेक',
          chip2: 'वैदिक विधि',
          chip3: '2 मिनट',
          pStatBadge: '⚡ इंस्टेंट ग्रह स्कैन पूरा हुआ',
          pStatSub: 'यह आपके जन्म विवरण पर आधारित एक स्वचालित प्रारंभिक प्रीव्यू है।',
          identText: '{name}, आपकी जन्म कुंडली के chart में career और leadership का मजबूत योग दिख रहा है।',
          doshTitle: '⚠ मजबूत नकारात्मक योग का संकेत',
          doshSub: 'कुंडली में एक ऐसा ग्रह संयोग दिख रहा है जो करियर और आर्थिक उन्नति में रुकावट पैदा कर सकता है। अगर इसे समय पर न समझा जाए तो प्रगति धीमी हो सकती है।',
          valTrig: 'क्या आपने पिछले 1–2 साल में काम में देरी, दबाव या अकारण रुकावट महसूस की है?',
          valYes: 'अगर हाँ, तो आपको अपनी पर्सनलाइज़्ड कुंडली रिपोर्ट बनवानी चाहिए।',
          pHead: 'बेसिक कुंडली रिपोर्ट',
          notBasicHead: 'बेसिक कुंडली में क्या नहीं मिलता',
          notBasicTag: 'लॉक्ड',
          metalHead: '',
          metalSub: '',
          lbl1: 'सटीक दोष का नाम',
          lbl2: 'गंभीरता का स्तर',
          lbl3: 'प्रभावित होने वाला क्षेत्र',
          lbl4: 'भाग्यशाली धातु (जन्म कुंडली आधारित)',
          lbl5: 'असरदार उपाय और सही समय',
          lbl6: '1-वर्ष का जोखिम (Risk) टाइमलाइन',
          lblVer: 'ज्योतिषी के मैनुअल सत्यापन की आवश्यकता है',
          hrHead: '🧿 रिपोर्ट कैसे तैयार होती है?',
          hrDesc: 'आपकी विस्तृत कुंडली रिपोर्ट हमारे ज्योतिषी खुद देखकर बनाते हैं। ग्रहों की स्थिति, दशा का समय और आपके लिए उचित उपाय सब कुछ ध्यान से लिखा जाता है।',
          hrDel: 'रिपोर्ट WhatsApp + Email पर भेजी जाती है।',
          lockTitle: 'आपकी व्यक्तिगत विस्तृत कुंडली रिपोर्ट में आपको क्या मिलेगा',
          v1: 'संपूर्ण दोष और दशा विश्लेषण',
          v2: 'सटीकता से परेशानी की गंभीरता का विश्लेषण',
          v3: 'आसान और व्यक्तिगत उपाय (Remedies)',
          v4: 'भाग्यशाली धातु और समय का मार्गदर्शन',
          v5: 'करियर और धन का रोडमैप',
          v6: 'अगले 12 महीनों का भविष्यफल',
          scarLimit: 'आज की मैन्युअल रिपोर्ट क्षमता लगभग भर चुकी है।',
          offSub: 'सीमित समय का ऑफर – 73% छूट',
          btnUnlock: 'पूरी कुंडली खोलें – ₹399',
          btnSkip: 'सीधे चेकआउट पर जाएं',
          stickHead: 'आज ही अपना दोष ठीक करें',
          stickSub: '',
          btnSticky: 'अभी खरीदें ₹399'
        },
        en: {
          step1Ind: 'Step 1 of 2',
          h1Title: 'Check your Kundali',
          h1Sub: 'Discover your true future and kundli details from your birth chart.',
          secName: 'Name & Gender',
          lblName: 'Your Name',
          lblGender: 'Gender',
          selGen: 'Select',
          genM: 'Male',
          genF: 'Female',
          secDob: 'Date of Birth',
          lblDay: 'Day',
          lblMonth: 'Month',
          lblYear: 'Year',
          secTimePlace: 'Time & Place',
          lblTime: 'Birth Time',
          lblPlace: 'Birth Place',
          infoWhy: 'Why needed?',
          infoDesc: 'Exact planetary positions are calculated using your date, time & place.',
          btnCheck: 'Check Kundli',
          chip1: '100% Free Check',
          chip2: 'Vedic Method',
          chip3: '2 mins',
          pStatBadge: 'Prarambhik grah sthiti ka sanket',
          pStatSub: 'This is a small top‑level preview based on your birth chart. The detailed report is always checked and written by an astrologer.',
          identText: '{name}, your birth chart shows a clear indication of strong ambition and leadership potential.',
          doshTitle: '⚠ Indication of a challenging yog',
          doshSub: 'There is a planetary combination in your kundli that can slow down career and financial growth. If not understood in time, progress may feel slower than expected.',
          valTrig: 'Have you felt delays, pressure, or unexpected roadblocks in the last 1–2 years?',
          valYes: 'If yes, you should get a personalized kundli report made.',
          pHead: 'Basic Kundli Report',
          notBasicHead: 'What’s not in the basic kundli',
          notBasicTag: 'Locked',
          metalHead: '',
          metalSub: '',
          lbl1: 'Exact Dosha Name',
          lbl2: 'Severity Level',
          lbl3: 'Grah Impact Area',
          lbl4: 'Lucky Metal (Birth Chart Based)',
          lbl5: 'Effective Remedies & Timing',
          lbl6: '1-Year Risk Timeline',
          lblVer: 'Needs astrologer manual verification',
          hrHead: '🧿 How is the report prepared?',
          hrDesc: 'Our astrologer personally checks your chart – planet strength, dasha timing and remedies are written specifically for you.',
          hrDel: 'Report is shared on WhatsApp + Email.',
          lockTitle: 'What You’ll Unlock In Your Detailed Personalized Kundli Report',
          v1: 'Complete Dosha & Dasha Breakdown',
          v2: 'Exact Severity Analysis',
          v3: 'Personalized Remedies (Easy-to-follow)',
          v4: 'Lucky Metal & Timing Guidance',
          v5: 'Career & Wealth Roadmap',
          v6: '12-Month Forecast',
          scarLimit: 'Today’s manual analysis capacity is almost full.',
          offSub: 'Limited-time offer – 73% off',
          btnUnlock: 'Unlock Full Kundli – ₹399',
          btnSkip: 'Directly go to checkout',
          stickHead: 'Fix Your Doshas Today',
          stickSub: '',
          btnSticky: 'Buy Now ₹399'
        }
      };

      var currentLang = 'hinglish';

      var TRAITS = {
        hinglish: [
          'Career me exceptional growth potential hai',
          'Strong leadership qualities aur samaj ko influence karne ki kshamta',
          'Creative and unique approach to complex problems',
          'Bade financial targets ko easily achieve karne ka yog',
          'Strong intuition aur aage ki situations ko bhapne ki taqat',
          'Apne business ya empire khada karne ka vishesh sahas',
          'Decision-making ability me extreme clarity',
          'Relationships aur high-level networking me kamaal ka success rate',
          'Sahas aur determination normal se bohot high',
          'Life me ek badi authority position haasil karne ka yog',
          'Bohot tezi se nayi skills sikhne ki shamta',
          'Wealth accumulation ka zabardast yog',
          'Foreign travel ya waha set hone ki strong possibilities',
          'Spiritual aur material dono level par balance banana',
          'Hidden enemies par asani se vijay prapt karne ki taqat',
          'Apne field me master aur respected professional banne ke indications'
        ],
        hi: [
          'करियर में अप्रत्याशित वृद्धि की अपार संभावनाएं हैं',
          'मजबूत नेतृत्व क्षमता और समाज को प्रभावित करने की विशेष शक्ति',
          'जटिल समस्याओं को सुलझाने का रचनात्मक और अनूठा दृष्टिकोण',
          'बड़े आर्थिक लक्ष्यों को सरलता से प्राप्त करने का विशेष योग',
          'मजबूत अंतर्ज्ञान और भविष्य की स्थितियों को पहले से भांपने की ताकत',
          'अपना खुद का साम्राज्य या व्यवसाय स्थापित करने का अदम्य साहस',
          'निर्णय लेने की क्षमता में अत्यधिक स्पष्टता',
          'रिश्तों और उच्च-स्तरीय नेटवर्किंग में अद्भुत सफलता दर',
          'सामान्य से बहुत अधिक साहस और दृढ़ संकल्प',
          'जीवन में एक बड़े अधिकारिक पद (Authority) को प्राप्त करने का प्रबल योग',
          'नई चीजों को अत्यंत शीघ्रता से सीखने की क्षमता',
          'धन संचय (Wealth accumulation) का जबरदस्त योग',
          'विदेश यात्रा या वहां बसने की मजबूत संभावनाएं',
          'आध्यात्मिक और भौतिक दोनों स्तरों पर बेहतरीन संतुलन बनाए रखना',
          'गुप्त शत्रुओं पर आसानी से विजय प्राप्त करने की ताकत',
          'अपने क्षेत्र में एक निपुण और सम्मानित पेशेवर बनने के स्पष्ट संकेत'
        ],
        en: [
          'Exceptional growth potential in your career path',
          'Strong leadership qualities and the ability to influence society',
          'A highly creative and unique approach to solving complex problems',
          'Special planetary alignment for achieving massive financial targets',
          'Powerful intuition and the foresight to anticipate future situations',
          'Unmatched courage to build and establish your own empire',
          'Extreme clarity in decision-making and thought processes',
          'Incredible success rate in relationship building and high-level networking',
          'Courage and determination that is much higher than average',
          'Strong likelihood of attaining a significant position of authority in life',
          'Remarkable ability to learn new things quickly and adapt',
          'A tremendous planetary combination for wealth accumulation',
          'Strong possibilities of foreign travel or settlement',
          'Maintaining an excellent balance between spiritual and material realms',
          'The inherent power to easily conquer hidden enemies',
          'Clear indications of becoming a master and highly respected professional in your field'
        ]
      };

      function hashString(str) {
        var hash = 0;
        for (var i = 0; i < str.length; i++) {
          hash = str.charCodeAt(i) + ((hash << 5) - hash);
        }
        return Math.abs(hash);
      }

      function pickTraits(name, dob, tob, place) {
        var str = (name || '').trim().toLowerCase() + (dob || '') + (tob || '') + (place || '').trim().toLowerCase();
        var num = hashString(str);

        var tList = TRAITS[currentLang] || TRAITS['hinglish'];
        if (!tList) return [];

        var idx1 = num % tList.length;
        var idx2 = (num * 3 + 7) % tList.length;
        var idx3 = (num * 11 + 13) % tList.length;

        if (idx1 === idx2) idx2 = (idx2 + 1) % tList.length;
        if (idx2 === idx3) idx3 = (idx3 + 1) % tList.length;
        if (idx1 === idx3) idx3 = (idx3 + 2) % tList.length;

        return [tList[idx1], tList[idx2], tList[idx3]];
      }

      function setLang(lang) {
        currentLang = lang;
        document.querySelectorAll('.lang-btn').forEach(function (b) {
          b.classList.toggle('active', b.getAttribute('data-lang') === lang);
        });
        document.querySelectorAll('[data-i18n]').forEach(function (el) {
          var key = el.getAttribute('data-i18n');
          if (PREVIEW_COPY[lang] && PREVIEW_COPY[lang][key]) {
            if (el.tagName === 'INPUT') {
              el.placeholder = PREVIEW_COPY[lang][key];
            } else {
              el.textContent = PREVIEW_COPY[lang][key];
            }
          }
        });

        var formPanel = document.getElementById('formPanel');
        if (formPanel && !formPanel.classList.contains('visible')) {
          var name = (document.getElementById('name').value || '').trim();
          var gender = (document.getElementById('gender').value || '').trim();
          var dobYear = document.getElementById('dobYear').value;
          var dobMonth = document.getElementById('dobMonth').value;
          var dobDay = document.getElementById('dobDay').value;
          var dob = dobYear && dobMonth && dobDay ? dobYear + '-' + dobMonth + '-' + dobDay : '';
          var th = document.getElementById('tobHour').value;
          var tm = document.getElementById('tobMin').value;
          var tap = document.getElementById('tobAmPm').value;
          var tob = th && tm && tap ? th + ':' + tm + ' ' + tap : '';
          var place = (document.getElementById('place').value || '').trim();

          var traits = pickTraits(name, dob, tob, place);
          var displayName = name.split(' ')[0] || name;

          var checkTitleTemplate = PREVIEW_COPY[currentLang]['titleCheck'] || '';
          var identTextTemplate = PREVIEW_COPY[currentLang]['identText'] || PREVIEW_COPY['hinglish']['identText'];

          var previewTitle = document.getElementById('previewTitle');
          if (previewTitle && checkTitleTemplate) previewTitle.textContent = checkTitleTemplate.replace('{name}', displayName);
          var idText = document.getElementById('identityText');
          if (idText) idText.textContent = identTextTemplate.replace('{name}', displayName);
          var tListEl = document.getElementById('traitsList');
          if (tListEl) tListEl.innerHTML = traits.map(function (t) { return '<li>' + t + '</li>'; }).join('');
        }
      }

      document.querySelectorAll('.lang-btn').forEach(function (btn) {
        btn.addEventListener('click', function () {
          setLang(this.getAttribute('data-lang'));
        });
      });
      setLang('hinglish');

      function emit(event, payload) {
        try { window.dataLayer = window.dataLayer || []; window.dataLayer.push(Object.assign({ event }, payload)); } catch (e) { }
        if (window._shubhmayTrack) window._shubhmayTrack(event, Object.assign({ page: 'kundli_preview' }, payload));
      }

      document.getElementById('kundliForm').addEventListener('submit', function (e) {
        e.preventDefault();
        var name = (document.getElementById('name').value || '').trim();
        var gender = (document.getElementById('gender').value || '').trim();
        var day = document.getElementById('dobDay').value;
        var month = document.getElementById('dobMonth').value;
        var year = document.getElementById('dobYear').value;
        var th = document.getElementById('tobHour').value;
        var tm = document.getElementById('tobMin').value;
        var tap = document.getElementById('tobAmPm').value;
        var place = (document.getElementById('place').value || '').trim();
        var dob = year && month && day ? year + '-' + month + '-' + day : '';
        var tob = th && tm && tap ? th + ':' + tm + ' ' + tap : '';
        if (!name || !gender || !dob || !tob || !place) return;

        emit('kundli_preview_submit', { name: name, gender: gender, dob: dob, tob: tob, place: place });

        var traits = pickTraits(name, dob, tob, place);
        var displayName = name.split(' ')[0] || name;
        var checkTitleTemplate = PREVIEW_COPY[currentLang]['titleCheck'] || '';
        var identTextTemplate = PREVIEW_COPY[currentLang]['identText'] || PREVIEW_COPY['hinglish']['identText'];

        var loaderEl = document.getElementById('kundliLoader');
        var loaderLineEl = document.getElementById('kundliLoaderLine');
        var loaderLines = [
          'Graho ki position analyse ho rahi hai…',
          'Janam lagna aur dashao ka pattern check ho raha hai…',
          'Career aur paison par grah ka asar scan ho raha hai…',
          'Nakshatra aur rashi ki detail nikal rahi hai…',
          'Dosha aur yog ka analysis ho raha hai…',
          'Report taiyar ho rahi hai…'
        ];
        var LOADER_DURATION_MS = 5000;

        function showPreviewPanel() {
          emit('step_view', { step_index: 2, step_name: 'preview', funnel: 'kundli_preview' });
          var pt = document.getElementById('previewTitle');
          if (pt && checkTitleTemplate) pt.textContent = checkTitleTemplate.replace('{name}', displayName);
          var idt = document.getElementById('identityText');
          if (idt) idt.textContent = identTextTemplate.replace('{name}', displayName);
          var tList = document.getElementById('traitsList');
          if (tList) tList.innerHTML = traits.map(function (t) { return '<li>' + t + '</li>'; }).join('');
          if (loaderEl) {
            loaderEl.classList.remove('visible');
            loaderEl.style.display = 'none';
            loaderEl.setAttribute('aria-hidden', 'true');
          }
          document.getElementById('formPanel').classList.remove('visible');
          document.getElementById('previewPanel').classList.add('visible');
          document.getElementById('previewPanel').scrollIntoView({ behavior: 'smooth' });
          var stickyBar = document.getElementById('stickyBar');
          if (stickyBar) stickyBar.classList.add('show');
        }

        if (loaderEl && loaderLineEl) {
          loaderEl.classList.add('visible');
          loaderEl.style.display = 'flex';
          loaderEl.setAttribute('aria-hidden', 'false');
          loaderLineEl.textContent = loaderLines[0];
          var idx = 0;
          var interval = setInterval(function () {
            idx = (idx + 1) % loaderLines.length;
            loaderLineEl.textContent = loaderLines[idx];
          }, 850);
          requestAnimationFrame(function () {
            requestAnimationFrame(function () {
              setTimeout(function () {
                clearInterval(interval);
                showPreviewPanel();
              }, LOADER_DURATION_MS);
            });
          });
        } else {
          showPreviewPanel();
        }
      });

      document.getElementById('btnUnlock').addEventListener('click', function () {
        emit('checkout_start', { step: 'kundli_preview_unlock', destination_url: CHECKOUT_URL });
        window.location.href = CHECKOUT_URL;
      });
      document.getElementById('btnSkipPreview').addEventListener('click', function () {
        emit('checkout_start', { step: 'kundli_preview_skip', destination_url: CHECKOUT_URL });
        window.location.href = CHECKOUT_URL;
      });
      document.getElementById('btnStickyUnlock').addEventListener('click', function () {
        emit('checkout_start', { step: 'kundli_preview_sticky', destination_url: CHECKOUT_URL });
        window.location.href = CHECKOUT_URL;
      });

      // Funnel Enhancement: URL Parsing
      try {
        var params = new URLSearchParams(window.location.search);
        var urlRashi = params.get('rashi');
        if (urlRashi) {
          // If Rashi comes from previous tool, we can show a small "Connected" message
          var formHero = document.querySelector('.form-hero p');
          if (formHero) {
            var rashiNames = { mesh: 'Mesh', vrishabh: 'Vrishabh', mithun: 'Mithun', kark: 'Kark', singh: 'Singh', kanya: 'Kanya', tula: 'Tula', vrishchik: 'Vrishchik', dhanu: 'Dhanu', makar: 'Makar', kumbh: 'Kumbh', meen: 'Meen' };
            var rn = rashiNames[urlRashi] || urlRashi;
            formHero.innerHTML = '<span style="color:var(--saffron);font-weight:700;">' + rn + ' Rashi detected.</span> Your exact lucky metal depends on your nakshatra and time of birth. Provide birth details below for the exact metal match and full kundli.';
          }
        }
      } catch (e) { }
    })();
  </script>
</body>

</html>